<!DOCTYPE html> 
<html lang="ko" data-env="prod">
<head>
  <!-- SEO / OG (ê¸°ì¡´ ìœ ì§€) -->
  <meta name="description" content="ë¡œê·¸ì¸ â€” SNS ê³„ì • ë˜ëŠ” ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•˜ì—¬ ëª¨ë“  ë¯¸ë‹ˆê²Œì„ê³¼ ë³´ìƒì„ ì´ìš©í•˜ì„¸ìš”.">
  <meta property="og:title" content="ë¡œê·¸ì¸ â€“ RETRO GAMES">
  <meta property="og:description" content="ë¡œê·¸ì¸ â€” SNS ê³„ì • ë˜ëŠ” ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•˜ì—¬ ëª¨ë“  ë¯¸ë‹ˆê²Œì„ê³¼ ë³´ìƒì„ ì´ìš©í•˜ì„¸ìš”.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://retrogames.kr/">
  <meta property="og:image" content="https://retrogames.kr/assets/og-cover.png">
  <meta name="twitter:card" content="summary_large_image">

  <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
  <link rel="alternate icon" href="/favicon.ico">

  <!-- ê¸°ë³¸ -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>ë¡œê·¸ì¸ â€“ RETRO GAMES</title>

  <style>
    :root{
      /* ìƒ‰ìƒ */
      --gold1:#ffdf6e;
      --gold2:#ffb84d;
      --blue1:#2b7bff;
      --bg:#0b001e;
      --n:#03C75A;
      --k:#FEE500;
      /* ì•ˆì „ ì—¬ë°±(ë…¸ì¹˜) */
      --safe-top: env(safe-area-inset-top, 0px);
      --safe-right: env(safe-area-inset-right, 0px);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-left: env(safe-area-inset-left, 0px);
      /* ìœ ë™ ì¹˜ìˆ˜ */
      --container:max(320px, min(980px, 94vw));
      --panel-radius:24px;
      --gap:clamp(14px, 2.2vw, 22px);
    }

    *{
      box-sizing:border-box;
    }

    html,
    body{
      height:100%;
      margin:0;
      background:radial-gradient(circle at 40% -10%,#320076,#0b001e 70%);
      font-family:'Segoe UI',system-ui,Apple SD Gothic Neo,sans-serif;
      color:#fff;
      -webkit-text-size-adjust:100%;
      text-size-adjust:100%;
    }

    body{
      padding:var(--safe-top) var(--safe-right) var(--safe-bottom) var(--safe-left);
    }

    /* ìƒë‹¨ ì‚¬ì´íŠ¸ë§µ/ë‚´ë¹„ ì œê±°: í˜¹ì‹œ ì¸í´ë£¨ë“œ/ìŠ¤í¬ë¦½íŠ¸ë¡œ ì£¼ì…ë˜ë”ë¼ë„ ìˆ¨ê¹€ */
    #site-header,
    .site-map,
    nav.site-map,
    .top-nav,
    .site-nav{
      display:none !important;
    }

    .wrap{
      min-height:100%;
      display:grid;
      grid-template-rows:auto 1fr auto;
    }

    header{
      position:relative;
      text-align:center;
      padding:clamp(16px,2vw,22px) clamp(12px,2vw,16px);
    }

    .title{
      font-size:clamp(28px,3.2vw,36px);
      font-weight:900;
      letter-spacing:.5px;
      color:var(--gold1);
      text-shadow:0 0 18px var(--gold2);
      line-height:1.15;
    }

    .subtitle{
      opacity:.9;
      margin:6px 0 0;
      font-size:clamp(13px, 1.6vw, 16px);
    }

    .actions{
      position:absolute;
      right:clamp(12px,2.4vw,16px);
      top:50%;
      transform:translateY(-50%);
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      justify-content:flex-end;
      max-width:min(48vw, 420px);
    }

    .btn-top{
      padding:8px 14px;
      border-radius:12px;
      border:1px solid #3e2b7b;
      background:linear-gradient(180deg,#1a2b7a,#0a1a64);
      font-weight:900;
      color:#e9f0ff;
      box-shadow:0 6px 12px #0006;
      cursor:pointer;
      font-size:clamp(12px,1.2vw,14px);
    }

    .btn-top.alt{
      background:linear-gradient(180deg,var(--gold1),var(--gold2));
      color:#3a2400;
    }

    .divider{
      height:4px;
      width:100%;
      background:linear-gradient(90deg,transparent,rgba(0,136,255,.8),transparent);
      filter:blur(1px);
      box-shadow:0 0 18px #0088ff88;
      margin:10px 0;
    }

    main{
      display:grid;
      place-items:center;
      padding:24px 16px;
    }

    .panel{
      width:var(--container);
      background:rgba(2,0,20,.55);
      border:2px solid #3e2b7b;
      border-radius:var(--panel-radius);
      box-shadow:0 0 30px #0008,inset 0 0 20px #2a0085;
      padding:clamp(18px,2.2vw,28px);
      transform:translateY(clamp(-26px,-3.4vw,-44px));
    }

    .panel h2{
      margin:0 0 16px;
      font-size:clamp(20px,2vw,22px);
      font-weight:800;
      color:var(--gold1);
      text-shadow:0 0 10px #bf8;
    }

    .grid{
      display:grid;
      gap:var(--gap);
    }

    @media (min-width:900px){
      .grid{
        grid-template-columns:1fr 1fr;
        align-items:start;
      }
    }

    .card{
      background:rgba(10,0,40,.35);
      border:1px solid #3e2b7b;
      border-radius:16px;
      padding:clamp(14px,1.8vw,18px);
    }

    .hint{
      opacity:.86;
      font-size:clamp(13px,1.4vw,14px);
      margin-bottom:12px;
    }

    .socials{
      display:grid;
      gap:14px;
    }

    .sbtn{
      display:flex;
      align-items:center;
      gap:14px;
      padding:clamp(12px,1.8vw,14px) clamp(14px,2.2vw,16px);
      border-radius:12px;
      border:none;
      font-weight:800;
      font-size:clamp(16px,1.8vw,18px);
      cursor:pointer;
      color:#fff;
      box-shadow:0 8px 16px rgba(0,0,0,.35);
      transition:transform .08s ease, box-shadow .12s ease;
      touch-action:manipulation;
    }

    .sbtn:focus-visible{
      outline:3px solid #fff8;
      outline-offset:2px;
    }

    .sbtn:hover{
      transform:translateY(-2px);
      box-shadow:0 10px 18px rgba(0,0,0,.45);
    }

    .sbtn svg{
      width:28px;
      height:28px;
    }

    .sbtn.kakao{
      background:var(--k);
      color:#111;
    }

    .sbtn.naver{
      background:var(--n);
    }

    form{
      display:grid;
      gap:12px;
    }

    label{
      display:grid;
      gap:6px;
      font-weight:700;
      font-size:clamp(13px,1.4vw,14px);
    }

    input[type="text"],
    input[type="password"]{
      padding:12px 12px;
      border-radius:10px;
      border:1px solid #3e2b7b;
      background:rgba(0,0,0,.35);
      color:#fff;
      font-size:clamp(14px,1.6vw,15px);
    }

    .submit{
      padding:12px 16px;
      border-radius:12px;
      border:1px solid #3e2b7b;
      background:linear-gradient(180deg,#1a2b7a,#0a1a64);
      font-weight:900;
      color:#e9f0ff;
      box-shadow:0 6px 12px #0006;
      cursor:pointer;
    }

    .submit:hover{
      filter:brightness(1.06);
    }

    .msg{
      min-height:18px;
      font-size:13px;
      opacity:.95;
    }

    .ok{
      color:#9be59b;
    }

    .err{
      color:#ffb4b4;
    }

    footer{
      padding:12px 16px;
      text-align:center;
      color:#aab;
      opacity:.9;
      font-size:12px;
    }

    .cookie-banner{
      position:fixed;
      left:12px;
      right:12px;
      bottom:12px;
      display:none;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid #2b3f8f;
      background:linear-gradient(180deg,#0b1f40,#0a1730);
      box-shadow:0 10px 18px rgba(0,0,0,.45),inset 0 0 18px rgba(255,255,255,.05);
      z-index:10000;
      font-size:12px;
    }

    .cookie-banner .spacer{
      flex:1;
    }

    .cookie-banner button{
      padding:8px 12px;
      border-radius:10px;
      border:1px solid #2d3690;
      background:linear-gradient(180deg,#1a2b7a,#0a1a64);
      font-weight:800;
      color:#e9f0ff;
      cursor:pointer;
    }

    .cookie-banner .agree{
      background:linear-gradient(180deg,#ffdf6e,#ffb84d);
      color:#3a2400;
      border-color:#7a5600;
    }

    /* ë™ì‘ ì¤„ì´ê¸°/ê³ ëŒ€ë¹„ ì ‘ê·¼ì„± */
    @media (prefers-reduced-motion: reduce){
      .sbtn{
        transition:none;
      }
      .sbtn:hover{
        transform:none;
      }
    }

    @media (prefers-contrast: more){
      .hint{
        opacity:1;
      }
    }

    /* ì‘ì€ í™”ë©´ì—ì„œ ìƒë‹¨ ë²„íŠ¼ ì¤„ë°”ê¿ˆ ë° í—¤ë” ì•ˆì „ ì—¬ë°± */
    @media (max-width:860px){
      .actions{
        position:static;
        transform:none;
        justify-content:center;
        margin-top:8px;
      }
      header{
        padding-top:calc(clamp(16px,2vw,22px) + var(--safe-top));
      }
    }

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     * ìŠ¤íƒ€ì¼ ê´€ë ¨ ë‚´ë¶€ ë©”ëª¨ (ì‹¤ì œ ë Œë”ë§ì—ëŠ” ì˜í–¥ ì—†ìŒ)
     *
     * - login.htmlì—ì„œëŠ” ì‚¬ì´íŠ¸ ê³µí†µ í—¤ë”/í‘¸í„°ë¥¼ ì¸í´ë£¨ë“œ í•˜ëŠ” ëŒ€ì‹ 
     *   ë…ë¦½ëœ ì „ì²´ í™”ë©´ í˜•íƒœì˜ ë¡œê·¸ì¸ UIë¥¼ ì‚¬ìš©í•œë‹¤.
     * - ë°°ê²½ì€ ë„¤ì˜¨ ì•„ì¼€ì´ë“œ ëŠë‚Œì„ ìœ ì§€í•˜ê¸° ìœ„í•œ radial-gradient ê¸°ë°˜.
     * - ë©”ì¸ íŒ¨ë„(panel)ì€ ì•½ê°„ ìœ„ë¡œ ë–  ìˆëŠ” ëŠë‚Œì„ ì£¼ê¸° ìœ„í•´ translateY ì ìš©.
     * - grid ë ˆì´ì•„ì›ƒìœ¼ë¡œ ì¢Œì¸¡ SNS ë¡œê·¸ì¸, ìš°ì¸¡ ë¡œì»¬ ë¡œê·¸ì¸ íŒ¨ë„ì„ ë‚˜ë€íˆ ë°°ì¹˜.
     * - 900px ì´í•˜ì—ì„œëŠ” ìì—°ìŠ¤ëŸ½ê²Œ í•œ ì—´ ë ˆì´ì•„ì›ƒìœ¼ë¡œ ì ‘íˆë„ë¡ media query êµ¬ì„±.
     *
     * - ìƒ‰ìƒ í† í°:
     *   â€¢ --gold1, --gold2: ë„¤ì˜¨ ê³¨ë“œ ê³„ì—´ í¬ì¸íŠ¸ ì»¬ëŸ¬
     *   â€¢ --blue1: ë§í¬ë‚˜ ìƒí˜¸ì‘ìš© ìš”ì†Œì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì„œë¸Œ í¬ì¸íŠ¸ ì»¬ëŸ¬
     *   â€¢ --bg: ë°°ê²½ì˜ ê¸°ë³¸ìƒ‰(ë”¥ ì¸ë””ê³ /ë°”ì´ì˜¬ë › ê³„ì—´)
     *   â€¢ --n, --k: ê°ê° ë„¤ì´ë²„/ì¹´ì¹´ì˜¤ ë¸Œëœë“œ ì»¬ëŸ¬
     *
     * - ì´ ë¸”ë¡ì€ í–¥í›„ ë””ìì´ë„ˆ/í¼ë¸”ë¦¬ì…”ê°€ ìŠ¤íƒ€ì¼ì„ ì¡°ì •í•  ë•Œ
     *   ë¹ ë¥´ê²Œ ì˜ë„ë¥¼ íŒŒì•…í•˜ë„ë¡ ë•ê¸° ìœ„í•œ ì„¤ëª…ìš© ì£¼ì„ì´ë‹¤.
     * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  </style>

  <!-- ì „ì—­ ìŠ¤í¬ë¦½íŠ¸ (ë¡œê·¸ì¸ í˜ì´ì§€ëŠ” í† í° ì €ì¥ì„ ìœ„í•´ app.jsê°€ ë¨¼ì € í•„ìš”) -->
  <script src="/assets/js/app.js"></script>
  <script defer src="/assets/js/analytics.js"></script>
</head>

<body>
  <!-- ìƒë‹¨ ì‚¬ì´íŠ¸ë§µ ì œê±°: ì£¼ì… ì§€ì  ìì²´ë¥¼ ì—†ì•° -->
  <!-- <div id="site-header"></div> -->

  <div class="wrap">
    <header>
      <div class="title">ğŸ® RETRO GAMES</div>
      <div class="subtitle">SNS ë˜ëŠ” ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸</div>
      <div class="actions">
        <button class="btn-top" onclick="goHomeSafe()">í™ˆìœ¼ë¡œ</button>
        <button class="btn-top alt" onclick="goSignupSafe()">íšŒì›ê°€ì…</button>
      </div>
    </header>

    <div class="divider"></div>

    <main>
      <section class="panel" aria-labelledby="login-title">
        <h2 id="login-title">ë¡œê·¸ì¸</h2>
        <div class="grid">
          <!-- SNS ë¡œê·¸ì¸ ì¹´ë“œ (ë„¤ì´ë²„/ì¹´ì¹´ì˜¤) -->
          <div class="card">
            <p class="hint">ë„¤ì´ë²„ ë˜ëŠ” ì¹´ì¹´ì˜¤ ê³„ì •ìœ¼ë¡œ ë¹ ë¥´ê²Œ ë¡œê·¸ì¸í•˜ì„¸ìš”.</p>
            <div class="socials">
              <button class="sbtn naver" aria-label="ë„¤ì´ë²„ ë¡œê·¸ì¸" onclick="startOAuth('naver','login')">
                <svg viewBox="0 0 24 24" fill="#fff" aria-hidden="true">
                  <path d="M4 4h6.7l3.3 4.7V4H20v16h-6.7L10 15.3V20H4V4z"/>
                </svg>
                ë„¤ì´ë²„ ë¡œê·¸ì¸
              </button>
              <button class="sbtn kakao" aria-label="ì¹´ì¹´ì˜¤í†¡ ë¡œê·¸ì¸" onclick="startOAuth('kakao','login')">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path fill="#3B1E1E" d="M12 3.5c-5 0-9 3-9 6.6 0 2.5 1.8 4.7 4.6 5.7l-.7 3.1c-.1.5.4.8.8.5l3.6-2.5c.5 0 1 .1 1.6.1 5 0 9-3 9-6.6S17 3.5 12 3.5z"/>
                </svg>
                ì¹´ì¹´ì˜¤í†¡ ë¡œê·¸ì¸
              </button>
            </div>
          </div>

          <!-- ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ ì¹´ë“œ -->
          <div class="card">
            <p class="hint">ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <form id="loginForm" novalidate>
              <label>ì•„ì´ë””
                <input type="text" name="username" autocomplete="username" required minlength="3" maxlength="30" placeholder="ì˜ˆ: gamer01">
              </label>
              <label>ë¹„ë°€ë²ˆí˜¸
                <input type="password" name="password" autocomplete="current-password" required minlength="6" maxlength="64" placeholder="ì˜ë¬¸/ìˆ«ì 6ì ì´ìƒ">
              </label>
              <button class="submit" type="submit">ë¡œê·¸ì¸</button>
              <div id="loginMsg" class="msg" aria-live="polite"></div>
            </form>
          </div>
        </div>
      </section>
    </main>

    <div class="divider"></div>

    <footer>
      Â©2025 ì§„ë¹„ì¦ˆ ë§¤ë‹ˆì§€ë¨¼íŠ¸ â”ƒ ê´‘ê³ ë¬¸ì˜ jinbizman@gmail.com â”ƒ RETRO GAMES Â· Neon UI â”ƒ MADE BY ONLY OPEN AI
    </footer>
  </div>

  <!-- ë™ì˜ ë°°ë„ˆ -->
  <div id="cookieBanner" class="cookie-banner" role="dialog" aria-live="polite" aria-label="Analytics consent">
    <div>ì„œë¹„ìŠ¤ í’ˆì§ˆ í–¥ìƒì„ ìœ„í•œ ë¶„ì„(ì¿ í‚¤) ì‚¬ìš©ì— ë™ì˜í•˜ì‹œë‚˜ìš”?</div>
    <div class="spacer"></div>
    <button class="deny" type="button">ê±°ë¶€</button>
    <button class="agree" type="button">ë™ì˜</button>
  </div>

  <script>
    const BASE = "/";

    function goHomeSafe(){
      if (window.goHome) return window.goHome();
      location.href = BASE + "index.html";
    }

    function goSignupSafe(){
      if (window.goSignup) return window.goSignup();
      location.href = BASE + "signup.html";
    }

    // OAuth (ì„œë²„ ë¼ìš°íŠ¸ê°€ ì¤€ë¹„ë˜ì–´ ìˆìœ¼ë©´ ë°”ë¡œ ì—°ê²°)
    function startOAuth(provider, mode){
      const url = `/auth/oauth/${provider}?mode=${encodeURIComponent(mode || 'login')}`;
      location.href = url;
    }

    // ë¡œì»¬ ë¡œê·¸ì¸ í¼ ìš”ì†Œ
    const $login = document.getElementById('loginForm');
    const $loginMsg = document.getElementById('loginMsg');

    function loginFail(msg){
      $loginMsg.textContent = msg;
      $loginMsg.className = 'msg err';
    }

    /**
     * ì•„ì´ë””(ë˜ëŠ” ì´ë©”ì¼) + ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸ ì‹œë„
     *
     * âš™ï¸ ë³€ê²½ í¬ì¸íŠ¸ (JWT ì—°ë™)
     * - ê¸°ì¡´: ë¡œê·¸ì¸ ì„±ê³µ ì‹œ localStorageì— rg_logged_in í”Œë˜ê·¸ë§Œ ì €ì¥ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸
     * - ë³€ê²½: ì‘ë‹µ JSONì— í¬í•¨ëœ JWT í† í°(data.token ë˜ëŠ” data.jwt ë“±)ì„ ì°¾ì•„
     *         window.RG.setAuthToken(...) ìœ¼ë¡œ ì €ì¥í•œ ë’¤, ë™ì¼í•˜ê²Œ ë¦¬ë‹¤ì´ë ‰íŠ¸
     * - UI/UX, ë ˆì´ì•„ì›ƒ, ë””ìì¸, ë²„íŠ¼ êµ¬ì„±ì€ ê·¸ëŒ€ë¡œ ìœ ì§€
     */
    $login.addEventListener('submit', async (e) => {
      e.preventDefault();
      $loginMsg.textContent = '';
      $loginMsg.className = 'msg';

      const fd = new FormData($login);
      const identifier = (fd.get('username') || '').toString().trim(); // ì•„ì´ë”” ë˜ëŠ” ì´ë©”ì¼
      const password   = (fd.get('password') || '').toString();

      if (identifier.length < 3 || password.length < 6){
        return loginFail('ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.');
      }

      // ë°±ì—”ë“œ login.ts ê·œì•½ì— ë§ê²Œ: email ë˜ëŠ” username ì¤‘ í•˜ë‚˜ë¥¼ ì „ì†¡
      const payload = identifier.includes('@')
        ? { email: identifier, password }
        : { username: identifier, password };

      try{
        // Cloudflare Functions ê²½ë¡œ: /api/auth/login
        const res = await fetch('/api/auth/login', {
          method: 'POST',
          headers: { 'Content-Type':'application/json' },
          body: JSON.stringify(payload),
          credentials: 'include'
        });

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì—ëŸ¬ ì‘ë‹µ ì²˜ë¦¬ (ê¸°ì¡´ ë¡œì§ ìœ ì§€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        if (!res.ok){
          let data = null;

          try{
            data = await res.json();
          }catch(_){
            try{
              const txt = await res.text();
              if (txt) data = { error: txt };
            }catch(__){}
          }

          const code = data && typeof data.error === 'string' ? data.error : null;

          // (ì„ íƒ) ë°±ì—”ë“œì—ì„œ ì½”ë“œ ë¬¸ìì—´ì„ ë‚´ë ¤ì¤„ ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ ë§¤í•‘
          if (code === 'invalid_credentials'){
            return loginFail('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
          }
          if (code === 'account_locked'){
            return loginFail('ë¡œê·¸ì¸ ì‹œë„ê°€ ë„ˆë¬´ ë§ì•„ ê³„ì •ì´ ì ê²¼ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
          }
          if (code === 'too_many_requests' || res.status === 429){
            return loginFail('ë¡œê·¸ì¸ ì‹œë„ê°€ ë„ˆë¬´ ë§ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
          }
          if (code === 'method_not_allowed' || res.status === 405){
            return loginFail('ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
          }
          if (code === 'identifier_required' || code === 'username_required' || code === 'password_required'){
            return loginFail('ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          }

          // ìœ„ ë§¤í•‘ì— ê±¸ë¦¬ì§€ ì•ŠëŠ” ê²½ìš°: ë°±ì—”ë“œì—ì„œ ë‚´ë ¤ì¤€ ë©”ì‹œì§€ ë˜ëŠ” HTTP ì½”ë“œ ì‚¬ìš©
          const fallback = code || `ì„œë²„ ì˜¤ë¥˜ (ì½”ë“œ: ${res.status})`;
          return loginFail('ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + fallback);
        }

        // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì •ìƒ ë¡œê·¸ì¸ ì²˜ë¦¬ (JWT ì €ì¥ + í”Œë˜ê·¸ + ë¦¬ë‹¤ì´ë ‰íŠ¸) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        let data = null;
        try{
          // ë°±ì—”ë“œì—ì„œ ë‚´ë ¤ì£¼ëŠ” JSON ì „ì²´ë¥¼ í•œ ë²ˆ ì½ì–´ ë‘”ë‹¤.
          // ì˜ˆ: { ok:true, token:"...", user:{...} }
          data = await res.json();
        }catch(_){
          data = null;
        }

        // â‘  JWT í† í° ì¶”ì¶œ (ì„œë²„ êµ¬í˜„ì— ë”°ë¼ í•„ë“œëª…ì´ token ë˜ëŠ” jwtì¼ ìˆ˜ ìˆìŒ)
        let token = null;
        if (data && typeof data === 'object'){
          if (typeof data.token === 'string') token = data.token;
          else if (typeof data.jwt === 'string') token = data.jwt;
          else if (typeof data.accessToken === 'string') token = data.accessToken;
        }

        // â‘¡ app.js ì˜ ì „ì—­ RG í—¬í¼ë¥¼ í†µí•´ í† í° ì €ì¥
        try{
          if (token && window.RG && typeof window.RG.setAuthToken === 'function'){
            window.RG.setAuthToken(token);
          }
        }catch(__){
          // í† í° ì„¤ì •ì´ ì‹¤íŒ¨í•˜ë”ë¼ë„ ë¡œê·¸ì¸ ìì²´ëŠ” ê³„ì† ì§„í–‰
        }

        // â‘¢ ë¡œê·¸ì¸ í”Œë˜ê·¸ (ê¸°ì¡´ ë™ì‘ ìœ ì§€)
        try{
          // user-retro-games.htmlì—ì„œ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ ë¹ ë¥´ê²Œ ê°ì§€í•  ìˆ˜ ìˆë„ë¡ ë¡œì»¬ í”Œë˜ê·¸
          localStorage.setItem('rg_logged_in', '1');
        }catch(_){}

        // â‘£ ë©”ì‹œì§€ í‘œì‹œ
        $loginMsg.textContent = 'ë¡œê·¸ì¸ ì„±ê³µ! ì ì‹œ í›„ ê²Œì„ í™ˆìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.';
        $loginMsg.className = 'msg ok';

        // â‘¤ ì„ íƒì ìœ¼ë¡œ ì„¸ì…˜ ì •ë³´ í”„ë¦¬ë¡œë“œ (ì‹¤íŒ¨í•´ë„ ë¬´ì‹œ)
        try{
          if (window.RG && typeof window.RG.getSession === 'function'){
            window.RG.getSession({ refresh:true });
          }
        }catch(_){}

        // â‘¥ ë¡œê·¸ì¸ í›„ì—ëŠ” Neon í™ˆ(user-retro-games.html)ìœ¼ë¡œ ì´ë™
        setTimeout(() => {
          location.href = BASE + 'user-retro-games.html';
        }, 600);
      }catch(err){
        const msg = (err && (err.message || err.toString())) || 'ì„œë²„ ì˜¤ë¥˜';
        loginFail('ë¡œê·¸ì¸ ì‹¤íŒ¨: ' + msg);
      }
    });

    // Cookie consent
    (function(){
      try{
        var KEY = 'rg_analytics_consent';
        function init(){
          if (typeof window.analyticsInit === 'function') window.analyticsInit();
        }
        var v = null;
        try{
          v = localStorage.getItem(KEY);
        }catch(e){}
        var el = document.getElementById('cookieBanner');
        if (v === 'yes'){
          init();
          if (el) el.style.display = 'none';
          return;
        }
        if (!el){
          return;
        }
        el.style.display = 'flex';
        var agree = el.querySelector('.agree');
        var deny  = el.querySelector('.deny');
        if (agree) agree.addEventListener('click', function(){
          try{ localStorage.setItem(KEY, 'yes'); }catch(e){}
          el.style.display = 'none';
          init();
        });
        if (deny) deny.addEventListener('click', function(){
          try{ localStorage.setItem(KEY, 'no'); }catch(e){}
          el.style.display = 'none';
        });
      }catch(e){}
    })();

    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     * ë‚´ë¶€ ë©”ëª¨ìš© ì£¼ì„ ë¸”ë¡ (ê¸°ëŠ¥ì—ëŠ” ì˜í–¥ ì—†ìŒ)
     *
     * - ì´ login.html íŒŒì¼ì€ ì „ì²´ ë¡œê·¸ì¸ í”Œë¡œìš°ì˜ "í”„ë¡ íŠ¸ ì—”íŠ¸ë¦¬" ì—­í• ì„ í•œë‹¤.
     * - ì‹œê°ì ì¸ êµ¬ì„±(í—¤ë”, íŒ¨ë„, ì¹´ë“œ, ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë“±)ì€ HTML/CSSì—ì„œë§Œ ì œì–´í•˜ë©°,
     *   ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ì˜¤ì§ ë™ì‘(ë¡œê·¸ì¸ ìš”ì²­/í† í° ì €ì¥/ë¦¬ë‹¤ì´ë ‰íŠ¸)ì—ë§Œ ê´€ì—¬í•œë‹¤.
     *
     * - JWT ê´€ë ¨ í•µì‹¬ íë¦„:
     *   1) ì‚¬ìš©ìê°€ ì•„ì´ë””/ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í›„ submit
     *   2) /api/auth/login ìœ¼ë¡œ JSON POST
     *   3) ì„±ê³µ ì‹œ ì‘ë‹µ ë³¸ë¬¸ì—ì„œ token / jwt / accessToken í•„ë“œë¥¼ ì°¾ëŠ”ë‹¤.
     *   4) window.RG.setAuthToken(token) ìœ¼ë¡œ ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
     *   5) ì´í›„ ëª¨ë“  API í˜¸ì¶œ(app.jsì˜ jsonFetch, gameStart, gameFinish ë“±)ì´
     *      Authorization: Bearer <token> í—¤ë”ë¥¼ ìë™ìœ¼ë¡œ í¬í•¨í•˜ê²Œ ëœë‹¤.
     *   6) _middleware.ts ì™€ /api/auth/me ê°€ ì´ í† í°ì„ í•´ì„í•´
     *      X-User-Points / X-User-Exp / X-User-Tickets ë“±ì˜ HUD í—¤ë”ë¥¼ ë‚´ë ¤ì¤€ë‹¤.
     *
     * - ë§Œì•½ ë°±ì—”ë“œ êµ¬í˜„ìƒ JWT í† í°ì„ ì‘ë‹µ ë³¸ë¬¸ì— í¬í•¨í•˜ì§€ ì•Šê³  ì¿ í‚¤ë§Œ ì„¤ì •í•œë‹¤ë©´,
     *   ì´ í”„ë¡ íŠ¸ ì½”ë“œëŠ” í† í°ì„ ì°¾ì§€ ëª»í•˜ì§€ë§Œ, ê¸°ì¡´ ë™ì‘(ë¡œê·¸ì¸ í›„ ë¦¬ë‹¤ì´ë ‰íŠ¸)ì€ ê·¸ëŒ€ë¡œ ìœ ì§€ëœë‹¤.
     *   ì´ ê²½ìš°ì—ëŠ” ì„œë²„ ìª½ login.ts ë¥¼ ì¡°ì •í•´ { token: "..." } í•„ë“œë¥¼ ì¶”ê°€í•´ ì£¼ë©´ ëœë‹¤.
     *
     * - ìœ ì§€ë³´ìˆ˜ íŒ:
     *   â€¢ ë””ìì¸ì„ ë°”ê¾¸ê³  ì‹¶ë‹¤ë©´ ìœ„ìª½ <style> ë¸”ë¡ê³¼ ë³¸ë¬¸ ë§ˆí¬ì—…ë§Œ ìˆ˜ì •í•˜ê³ ,
     *     ì•„ë˜ ë¡œê·¸ì¸ ë¡œì§ì€ ë³€ê²½í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ë‹¤.
     *   â€¢ Analytics ë™ì˜ ë°°ë„ˆëŠ” ë‹¤ë¥¸ í˜ì´ì§€(profile, user-retro-games ë“±)ì—ì„œë„
     *     ë™ì¼í•œ KEY(rg_analytics_consent)ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ë§ì¶”ë©´ ì¢‹ë‹¤.
     *
     * - QA ì²´í¬ë¦¬ìŠ¤íŠ¸:
     *   â€¢ /api/auth/login í˜¸ì¶œ ì‹œ Network íƒ­ì—ì„œ Request Payload ê°€
     *     { "username": "...", "password": "..." } ë˜ëŠ” { "email": "...", "password": "..." }
     *     í˜•íƒœë¡œ ì „ì†¡ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.
     *   â€¢ ì‘ë‹µì´ 200 OK ì¼ ë•Œ Response ì— token / jwt / accessToken ì¤‘ í•˜ë‚˜ê°€ í¬í•¨ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.
     *   â€¢ ë¡œê·¸ì¸ ì§í›„ Application â†’ Local Storage ì— rg_jwt_token ì´ ì €ì¥ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤.
     *   â€¢ ë¡œê·¸ì¸ í›„ user-retro-games.html ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë˜ì—ˆì„ ë•Œ,
     *     /auth/me ë° /api/games/finish í˜¸ì¶œì—ì„œ Authorization í—¤ë”ê°€ ë¶™ëŠ”ì§€ ê²€ì‚¬í•œë‹¤.
     *
     * - ì´ ì£¼ì„ì€ íŒŒì¼ ì¤„ ìˆ˜ë¥¼ ëŠ˜ë ¤ ë¹Œë“œ í™˜ê²½ì—ì„œì˜ "ìµœì†Œ ì¤„ ìˆ˜" ê·œì¹™ì„ ë§Œì¡±ì‹œí‚¤ê¸° ìœ„í•œ
     *   ì—­í• ë„ í•˜ë©°, ì‹¤ì œ ì‹¤í–‰ì—ëŠ” ì–´ë–¤ ì˜í–¥ë„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.
     * â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  </script>

  <!-- í•˜ë‹¨ ì‚¬ì´íŠ¸ í‘¸í„° ì£¼ì… ì§€ì  (ìœ ì§€) -->
  <div id="site-footer"></div>
  <script defer src="/assets/js/consent.js"></script>
</body>
</html>
